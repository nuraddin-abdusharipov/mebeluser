<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mebel Katalogi - Mebel Markazi</title>
    <meta name="description" content="Mebel Markazi - Keng assortimentdagi zamonaviy mebellar">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <a href="index.html" class="logo">
                <img src="https://i.ibb.co/6yF1s9H/logo-placeholder.png" alt="Mebel Markazi Logo">
                <span>Mebel Markazi</span>
            </a>
            <nav class="main-nav">
                <ul>
                    <li><a href="index.html">Bosh sahifa</a></li>
                    <li><a href="mebel.html" class="active">Mahsulotlar</a></li>
                    <li><a href="#">Biz haqimizda</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Aloqa</a></li>
                </ul>
            </nav>
            <div class="header-icons">
                <a href="#" class="search-icon"><i class="fas fa-search"></i></a>
                <a href="#" class="cart-icon" id="cart-toggle"><i class="fas fa-shopping-cart"></i><span id="cart-count">0</span></a>
                <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
            </div>
        </div>
    </header>

    <!-- Mebel Katalogi -->
    <main class="catalog-page">
        <section class="section-padding">
            <div class="container">
                <div class="section-header">
                    <h2>Mebel Katalogi</h2>
                    <p>Bizning keng assortimentimiz bilan tanishing</p>
                </div>

                <!-- Filtrlar -->
                <div class="filters">
                    <div class="filter-group">
                        <label for="category">Kategoriya:</label>
                        <select id="category">
                            <option value="all">Barchasi</option>
                            <option value="living">Mehmonxona</option>
                            <option value="bedroom">Yotoq xonasi</option>
                            <option value="kitchen">Oshxona</option>
                            <option value="office">Ofis</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="price">Narx:</label>
                        <select id="price">
                            <option value="all">Barchasi</option>
                            <option value="0-5000000">5 000 000 so'm gacha</option>
                            <option value="5000000-10000000">5-10 mln so'm</option>
                            <option value="10000000-20000000">10-20 mln so'm</option>
                            <option value="20000000+">20 mln so'mdan yuqori</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="sort">Saralash:</label>
                        <select id="sort">
                            <option value="default">Standart</option>
                            <option value="price-low">Arzondan qimmatga</option>
                            <option value="price-high">Qimmatdan arzonga</option>
                            <option value="name">Alfabit bo'yicha</option>
                        </select>
                    </div>
                </div>

                <!-- Mahsulotlar Grid -->
                <div class="products-grid" id="products-container">
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <p>Firebase yuklanmoqda...</p>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination">
                    <button class="pagination-btn" id="prev-page" disabled>
                        <i class="fas fa-chevron-left"></i> Oldingi
                    </button>
                    <div class="page-numbers" id="page-numbers">
                        <!-- Sahifa raqamlari -->
                    </div>
                    <button class="pagination-btn" id="next-page">
                        Keyingi <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer (qisqartirilgan) -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 Mebel Markazi. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <!-- Modal oynalar -->
    <div id="quick-view-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-body">
                <div class="modal-image">
                    <img id="modal-product-image" src="" alt="Mahsulot rasmi">
                </div>
                <div class="modal-details">
                    <h2 id="modal-product-name">Mahsulot nomi</h2>
                    <div class="price" id="modal-product-price">0 so'm</div>
                    <div class="description">
                        <p>Bu mahsulot eng yuqori sifatli materiallardan tayyorlangan.</p>
                    </div>
                    <button class="btn btn-primary add-to-cart-modal">Savatga qo'shish</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scriptlar -->
<script type="module">
    // Firebase config import qilish
    import { db } from './firebase-config.js';
    import { 
        collection, 
        getDocs
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // Sodda mahsulot yuklash
    async function loadProducts() {
        try {
            console.log("Mahsulotlar yuklanmoqda...");
            const querySnapshot = await getDocs(collection(db, "products"));
            const container = document.getElementById("products-container");
            
            if (querySnapshot.empty) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <h3>Hozircha mahsulotlar mavjud emas</h3>
                        <p>Admin panel orqali mahsulot qo'shing</p>
                        <a href="admin-add.html" class="btn btn-primary">Mahsulot qo'shish</a>
                    </div>
                `;
                return;
            }

            let productsHTML = '';
            querySnapshot.forEach((doc) => {
                const product = doc.data();
                productsHTML += `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${product.imageBase64 || 'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=350&h=350&fit=crop'}" alt="${product.name}">
                            <div class="product-actions">
                                <button class="action-btn quick-view" data-product-id="${doc.id}">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn add-to-cart" data-name="${product.name}" data-price="${product.price}">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p class="product-price">${product.price ? product.price.toLocaleString() : 0} so'm</p>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = productsHTML;
            
        } catch (error) {
            console.error("Xatolik:", error);
            document.getElementById("products-container").innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: red;">
                    <p>Mahsulotlarni yuklashda xatolik: ${error.message}</p>
                </div>
            `;
        }
    }

    // DOM yuklanganda mahsulotlarni yuklash
    document.addEventListener('DOMContentLoaded', loadProducts);
</script>
    <script src="firebase-loader.js"></script>
    <script src="catalog.js"></script>
    <script src="script.js"></script>
</body>
</html>
